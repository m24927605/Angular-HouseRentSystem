<br>
<div>
  <div class="search-bar inline-block">
    <nz-input [(ngModel)]='inputValue' nzPlaceHolder="房號"></nz-input>
    <button nz-button [nzType]="'primary'" (click)="search()">
      <i class="anticon anticon-search"></i>
      <span>查詢</span>
    </button>
  </div>
</div>
<br>
<nz-table #nzTable [nzAjaxData]="data" [nzLoading]="_loading" [nzIsPagination]="false">
  <thead nz-thead>
    <tr>
      <th nz-th nzExpand></th>
      <th nz-th>
        <span>房號</span>
      </th>
      <th nz-th>
        <span>房客姓名</span>
      </th>
      <th nz-th>
        <span>繳費種類</span>
      </th>
      <th nz-th>
        <span>租約起始時間</span>
      </th>
      <th nz-th>
        <span>租約結束時間</span>
      </th>
      <th nz-th>
        <span>入住時間</span>
      </th>
      <th nz-th>
        <span>搬離時間</span>
      </th>
      <th nz-th>
        <span>動作</span>
      </th>
    </tr>
  </thead>
  <tbody nz-tbody>
    <ng-template ngFor let-data [ngForOf]="nzTable.data">
      <tr nz-tbody-tr>
        <td nz-td nzExpand>
          <nz-row-expand-icon [(nzExpand)]="data.expand"></nz-row-expand-icon>
        </td>
        <td nz-td>{{data.RoomNo}}</td>
        <td nz-td>{{data.UserDetails[0].UserName}}</td>
        <td nz-td>{{data.CalculateType}}</td>
        <td nz-td>{{data.RentStartDate | amDateFormat: 'YYYY-MM-DD'}}</td>
        <td nz-td>{{data.RentEndDate | amDateFormat: 'YYYY-MM-DD'}}</td>
        <td nz-td>{{data.EnterDate | amDateFormat: 'YYYY-MM-DD'}}</td>
        <td nz-td>{{data.LeaveDate | amDateFormat: 'YYYY-MM-DD'}}</td>
        <td nz-td>
          <a routerLink="/rent/payflow" [queryParams]="{RoomNo: data.RoomNo}">編輯</a>
          <span nz-table-divider></span>
          <span>
            <a routerLink="/rent/payflow" [queryParams]="{RoomNo: data.RoomNo}">查詢繳費紀錄</a>
          </span>
        </td>
      </tr>
      <tr nz-tbody-tr *ngIf="data.expand">
        <td nz-td></td>
        <td nz-td colspan="3">
          <h2>房客資訊</h2>
          <br> 性別
          <span nz-table-divider></span>{{data.UserDetails[0].Sex}}
          <br>
          <br> 生日
          <span nz-table-divider></span>{{data.UserDetails[0].Birth | amDateFormat:'YYYY-MM-DD'}}
          <br>
          <br> Email
          <span nz-table-divider></span>{{data.UserDetails[0].Email}}
          <br>
          <br> 電話
          <span nz-table-divider></span>{{data.UserDetails[0].Phone}}
          <br>
          <br> 身分證字號
          <span nz-table-divider></span>{{data.UserDetails[0].IDCardNo}}
          <br>
          <br> 地址
          <span nz-table-divider></span>{{data.UserDetails[0].Address}}
          <br>
          <br> 職業
          <span nz-table-divider></span>{{data.UserDetails[0].Career}}
          <br>
          <br> 緊急聯絡人
          <span nz-table-divider></span>{{data.UserDetails[0].ContactUser}}
          <br>
          <br> 緊急聯絡人電話
          <span nz-table-divider></span>{{data.UserDetails[0].ContactUserPhone}}
          <br>
        </td>
        <td nz-td colspan="6">
          <h2>該房客繳交狀況</h2>
          <br>
          <ng-template ngFor let-item [ngForOf]="data.UserDetails[0].PayFlows">
            房號
            <span nz-table-divider></span>{{item.RoomNo}}
            <br> 使用電量
            <span nz-table-divider></span>{{item.PowerQty}}
            <br>租期
            <span nz-table-divider></span>{{item.RentPeriod| amDateFormat:'YYYY-MM'}}
            <br>繳交時間
            <span nz-table-divider></span>{{item.TimeOfPayment| amDateFormat:'YYYY-MM-DD'}}
            <br> 繳交金額
            <span nz-table-divider></span>{{item.Payment}}
            <br>
            <br>
          </ng-template>
        </td>
      </tr>
    </ng-template>
  </tbody>
</nz-table>
<nz-pagination class="float-right" [nzPageIndex]="currentPage" [nzTotal]="total" [nzPageSize]="pageSize" nzSize="small" (nzPageIndexChange)="pageChange($event)"
  nzShowQuickJumper nzShowTotal>
</nz-pagination>